# Wazuh Agent Windows Integration Guide

## Part 1: Windows Agent Installation

### Step 1.1: Prepare Windows Host

Ensure the following requirements are met:

| Requirement | Specification |
|-------------|---------------|
| **Operating System** | Windows 10/11, Windows Server 2016+ |
| **Architecture** | x64 (64-bit) |
| **Network Access** | Connectivity to Wazuh Manager on ports 1514, 1515 |
| **Privileges** | Administrator rights for installation |

### Step 1.2: Download and Install Wazuh Agent

#### Method 1: PowerShell Installation (Recommended)

Open PowerShell as Administrator and execute:

```powershell
# Download the latest Wazuh Agent
Invoke-WebRequest -Uri "https://packages.wazuh.com/4.x/windows/wazuh-agent-4.12.0-1.msi" -OutFile "wazuh-agent.msi"

# Install with manager configuration
# Replace YOUR_MANAGER_IP with your Debian server IP address
msiexec.exe /i wazuh-agent.msi /q WAZUH_MANAGER="YOUR_MANAGER_IP" WAZUH_REGISTRATION_SERVER="YOUR_MANAGER_IP"
```

#### Method 2: GUI Installation

1. **Download**: Visit the Wazuh downloads page or use the PowerShell command above
2. **Run Installer**: Execute the MSI file as Administrator
3. **Configure Manager**: 
   - Enter Manager IP: Your Debian server IP address
   - Agent Name: Choose a descriptive name (e.g., "Windows-Workstation-01")
4. **Complete Installation**: Follow the installation wizard

### Step 1.3: Verify Agent Registration

On your Wazuh Manager (Debian server), verify the agent registration:

#### List All Registered Agents
```bash
sudo /var/ossec/bin/manage_agents -l
```

#### Check Agent Connection Status
```bash
sudo /var/ossec/bin/agent_control -lc
```

**Expected Output Example:**
```
Wazuh agent_control. List of available agents:
   ID: 001, Name: Windows-Workstation-01, IP: 192.168.1.100, Active
```

#### Apply Configuration Changes
```bash
sudo systemctl restart wazuh-manager
```

### Step 1.4: Verify Data Flow

1. **Check Kibana**: Navigate to Discover and look for events from the new agent
2. **Filter by Agent**: Use `agent.name: "your-windows-host"` in KQL
3. **Verify Timestamps**: Ensure events are recent and flowing

---


### Documentation Links
- [Kibana Dashboard Documentation](https://www.elastic.co/guide/en/kibana/current/dashboard.html)
- [Wazuh Agent Installation Guide](https://documentation.wazuh.com/current/installation-guide/wazuh-agent/)
- [KQL Query Language Reference](https://www.elastic.co/guide/en/kibana/current/kuery-query.html)

### Community Resources
- [Wazuh Community Forum](https://wazuh.com/community/)
- [Elastic Community Forum](https://discuss.elastic.co/)
- [Security Dashboard Templates](https://github.com/elastic/examples)

---


